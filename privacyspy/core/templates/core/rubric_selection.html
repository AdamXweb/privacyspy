{% load humanize %}
{% load markdown_deux_tags %}

<div class="rubric-selection">
    <div class="selection-overview" onclick="toggleRubricSelection('#selection-{{selection.id}}')">
        <div class="columns is-mobile">
            <div class="column is-narrow">
                <h4 class="is-size-5">
                    <span class="icon">
                        <i class="fas fa-chevron-down" id="selection-{{selection.id}}-icon"></i>
                    </span>
                </h4>
            </div>
            <div class="column is-narrow">
                <h4 class="is-size-5">
                    <span class="icon">
                        <i class="fas fa-circle {{selection.option.color}}"></i>
                    </span>
                </h4>
            </div>
            <div class="column">
                <h4 class="is-size-5 is-upped-slight">
                    <div class="answer">
                        <span>{{selection.option.question.text}}</span>
                        <span class="has-text-grey-light"> {{selection.option.text}}</span>
                    </div>
                </h4>
            </div>
            <div class="column is-narrow is-upped-slight">
                <h4 class="is-size-4">
                    {{selection.option.value|floatformat:"-1"}}<span
                        class="rating-total has-text-grey-light">/{{selection.option.question.max_value|floatformat:"-1"}}</span>
                </h4>
            </div>
        </div>
    </div>
    <div class="selection-expanded" id="selection-{{selection.id}}">
        <div class="box is-margined">
            <p class="has-margin-bottom"><small class="has-text-grey">Decided {{selection.updated|naturalday}}. This question accounts for
                    {{selection.option.question.weight|floatformat:"0"}}% of the final score.</small></p>
            {% if selection.option.description %}
            <div class="notification content">{{selection.option.description|markdown}}</div>
            {% endif %}
            {% if selection.option.question.description %}
            <div class="notification content">{{selection.option.question.description|markdown}}</div>
            {% endif %}
            <div class="columns">
                <div class="column">
                    <p class="heading">Possible Options</p>
                    <table class="table is-fullwidth is-striped">
                        {% for option in selection.option.question.options %}
                        <tr {% if option == selection.option %}class="is-selected is-light" {% endif %}>
                            <td title="{{option.description}}">{{option.text}}</td>
                            <td><strong>{{option.value|floatformat:"-1"}}</strong>/{{option.question.max_value|floatformat:"-1"}}
                            </td>
                        </tr>
                        {% endfor %}
                    </table>
                </div>
                {% if selection.citation %}
                <div class="column">
                    <p class="heading">Citation</p>
                    <div class="content">
                        <blockquote class="abbreviated">
                            {{selection.citation|markdown}}
                        </blockquote>
                    </div>
                </div>
                {% endif %}
                {% if selection.note %}
                <div class="column">
                    <p class="heading">Note</p>
                    <div class="content abbreviated">{{selection.note|markdown}}</div>
                </div>
                {% endif %}
            </div>
            <p><small class="has-text-grey">
                    <a href="{% url 'create_suggestion' %}?policy={{policy.id}}&selection={{selection.id}}">Click
                        here</a>
                    to suggest a change or to flag this conclusion as incorrect, or <a href="/about/">here</a> for more
                    information.
                </small></p>
        </div>
    </div>
    <br>
</div>